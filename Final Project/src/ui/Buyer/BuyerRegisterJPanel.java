/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package ui.Buyer;

import Business.EcoSystem;
import Business.UserAccount.UserAccount;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import Business.Buyer.Buyer;
import Business.DB4OUtil.DB4OUtil;
import Business.Enterprise.Buy;
import Business.Role.BuyerRole;
import Business.Router;

/**
 *
 * @author Zhe Li
 */
public class BuyerRegisterJPanel extends javax.swing.JPanel {

    /**
     * Creates new form BuyerRegisterJPanel
     */
    JPanel container;
    private EcoSystem system;
    
    /*
    public BuyerRegisterJPanel() {
        initComponents();
    }
    */
    
    //根据MainJFrame的提示自动加的，还没改→已改
    public BuyerRegisterJPanel(JPanel container, EcoSystem system) {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
        initComponents();
        this.system = system;
        this.container = container;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        lblUsername = new javax.swing.JLabel();
        txtUsername = new javax.swing.JTextField();
        lblPassword = new javax.swing.JLabel();
        txtPassword = new javax.swing.JTextField();
        lblRePassword = new javax.swing.JLabel();
        txtRePassword = new javax.swing.JTextField();
        lblEmail = new javax.swing.JLabel();
        txtEmail = new javax.swing.JTextField();
        lblPhoneNum = new javax.swing.JLabel();
        txtPhoneNum = new javax.swing.JTextField();
        btnRegister = new javax.swing.JButton();
        backButton = new javax.swing.JButton();
        jLabel2 = new javax.swing.JLabel();

        setLayout(null);

        jLabel1.setFont(new java.awt.Font("Lucida Grande", 1, 13)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(255, 255, 0));
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText("Create new buyer here");
        add(jLabel1);
        jLabel1.setBounds(270, 200, 550, 19);

        lblUsername.setFont(new java.awt.Font("Lucida Grande", 1, 13)); // NOI18N
        lblUsername.setForeground(new java.awt.Color(255, 255, 102));
        lblUsername.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblUsername.setText("Username:");
        add(lblUsername);
        lblUsername.setBounds(370, 250, 124, 26);
        add(txtUsername);
        txtUsername.setBounds(570, 250, 124, 24);

        lblPassword.setFont(new java.awt.Font("Lucida Grande", 1, 13)); // NOI18N
        lblPassword.setForeground(new java.awt.Color(255, 255, 102));
        lblPassword.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblPassword.setText("Password:");
        add(lblPassword);
        lblPassword.setBounds(370, 290, 124, 26);
        add(txtPassword);
        txtPassword.setBounds(570, 290, 124, 24);

        lblRePassword.setFont(new java.awt.Font("Lucida Grande", 1, 13)); // NOI18N
        lblRePassword.setForeground(new java.awt.Color(255, 255, 102));
        lblRePassword.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblRePassword.setText("Re_Password:");
        add(lblRePassword);
        lblRePassword.setBounds(370, 340, 124, 26);
        add(txtRePassword);
        txtRePassword.setBounds(570, 340, 124, 24);

        lblEmail.setFont(new java.awt.Font("Lucida Grande", 1, 13)); // NOI18N
        lblEmail.setForeground(new java.awt.Color(255, 255, 102));
        lblEmail.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblEmail.setText("Email:");
        add(lblEmail);
        lblEmail.setBounds(370, 380, 124, 26);
        add(txtEmail);
        txtEmail.setBounds(570, 380, 124, 24);

        lblPhoneNum.setFont(new java.awt.Font("Lucida Grande", 1, 13)); // NOI18N
        lblPhoneNum.setForeground(new java.awt.Color(255, 255, 102));
        lblPhoneNum.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        lblPhoneNum.setText("Phone Number:");
        add(lblPhoneNum);
        lblPhoneNum.setBounds(370, 420, 124, 26);
        add(txtPhoneNum);
        txtPhoneNum.setBounds(570, 420, 124, 24);

        btnRegister.setBackground(new java.awt.Color(255, 204, 204));
        btnRegister.setFont(new java.awt.Font("Lucida Grande", 1, 13)); // NOI18N
        btnRegister.setForeground(new java.awt.Color(102, 153, 255));
        btnRegister.setText("Register");
        btnRegister.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRegisterActionPerformed(evt);
            }
        });
        add(btnRegister);
        btnRegister.setBounds(490, 490, 85, 27);

        backButton.setText("<< Back");
        backButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                backButtonActionPerformed(evt);
            }
        });
        add(backButton);
        backButton.setBounds(350, 490, 89, 27);

        jLabel2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/resource/6905b594d7eab2eafa12cd1d1022f3cd.jpeg"))); // NOI18N
        jLabel2.setText("as");
        add(jLabel2);
        jLabel2.setBounds(0, 0, 1140, 810);
    }// </editor-fold>//GEN-END:initComponents

    private void btnRegisterActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRegisterActionPerformed
        // TODO add your handling code here:
        // Get user name
        String userName = txtUsername.getText();
        // Get Password
        /*
        char[] passwordCharArray = txtPassword.getPassword();
        char[] repasswordCharArray = txtRePassword.getPassword();
        String repassword = String.valueOf(repasswordCharArray);
        String password = String.valueOf(passwordCharArray);
*/
        String password =  txtPassword.getText();
        String repassword = txtRePassword.getText();
        
        String email = txtEmail.getText();
        String phoneNum = txtPhoneNum.getText();
        
        if(userName.isEmpty() || password.isEmpty() || repassword.isEmpty())
        {
            JOptionPane.showMessageDialog(null, "Please input username or password!");
            return;
        }
        if(email.isEmpty()) {
            JOptionPane.showMessageDialog(null, "Please input your email!");
            return;
        }
        
        
        
        /*
        if(!ecoSystem.checkIfUserIsUnique(userName)){
            JOptionPane.showMessageDialog(null, "User name has existed!");
            return;
        }
*/
        
        if(!repassword.equals(password))
        {
            JOptionPane.showMessageDialog(null, "Password and Re_Password are not same, Please Check!");
            return;
        }
        
        //UserAccount customerAccount = deliveryService.addCustomer(userName, password);
        
        system.getUserAccountDirectory().createUserAccount(userName, password, new BuyerRole());
        DB4OUtil.getInstance().storeSystem(system);
        JOptionPane.showMessageDialog(null, "Register Buyer Successfully!");
        
        //buyer.setEmail(email);
        //customerAccount.setAddress(address);
        //JOptionPane.showMessageDialog(null, "Register Customer Successfully!");
        //populate();
        txtUsername.setText("");
        txtPassword.setText("");
        txtRePassword.setText("");
        txtEmail.setText("");
        txtPhoneNum.setText("");
        
        
    }//GEN-LAST:event_btnRegisterActionPerformed

    private void backButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_backButtonActionPerformed
        Router.getInstance(null).back(0);
    }//GEN-LAST:event_backButtonActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton backButton;
    private javax.swing.JButton btnRegister;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel lblEmail;
    private javax.swing.JLabel lblPassword;
    private javax.swing.JLabel lblPhoneNum;
    private javax.swing.JLabel lblRePassword;
    private javax.swing.JLabel lblUsername;
    private javax.swing.JTextField txtEmail;
    private javax.swing.JTextField txtPassword;
    private javax.swing.JTextField txtPhoneNum;
    private javax.swing.JTextField txtRePassword;
    private javax.swing.JTextField txtUsername;
    // End of variables declaration//GEN-END:variables
}
